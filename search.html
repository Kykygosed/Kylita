<!DOCTYPE html>
<html>
<head>
  <title>Recherche de musiques</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom, #222, #444);
      color: white;
      font-family: sans-serif;
    }

    .search-bar {
      width: 80%;
      margin: 30px auto;
      padding: 15px;
      border-radius: 10px;
      border: none;
      font-size: 20px;
    }

    .result {
      background-color: #1e88e5;
      border-radius: 12px;
      margin: 10px auto;
      padding: 15px;
      width: 80%;
      cursor: pointer;
    }

    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1e88e5;
      border-radius: 15px;
      padding: 20px;
      display: none;
      z-index: 1000;
    }

    .popup button {
      background: white;
      color: #1e88e5;
      border: none;
      border-radius: 10px;
      padding: 10px 20px;
      font-weight: bold;
      cursor: pointer;
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <h1 style="text-align: center; font-size: 40px;">Kylita</h1>
  <input type="text" class="search-bar" placeholder="Rechercher une musique..." oninput="searchMusic(this.value)" />

  <div id="results"></div>

  <div class="popup" id="popup">
    <h2 id="popupTitle"></h2>
    <audio id="audioPlayer" controls style="width: 100%; margin-top: 15px;"></audio>
    <div style="margin-top: 20px;">
      <button onclick="closePopup()">Fermer</button>
    </div>
  </div>

  <script>
    let musics = [];

    fetch('musics.json')
      .then(res => res.json())
      .then(data => {
        musics = data;
        searchMusic(""); // Show all at first
      });

    function searchMusic(query) {
      const results = document.getElementById('results');
      results.innerHTML = '';

      const filtered = musics.filter(m =>
        m.title.toLowerCase().includes(query.toLowerCase())
      );

      if (filtered.length === 0) {
        results.innerHTML = '<p style="text-align:center;">Aucun r√©sultat</p>';
        return;
      }

      filtered.forEach(music => {
        const div = document.createElement('div');
        div.className = 'result';
        div.innerHTML = `<strong>${music.title}</strong><br><span>${music.file}</span>`;
        div.onclick = () => openPopup(music);
        results.appendChild(div);
      });
    }

    function openPopup(music) {
      const popup = document.getElementById('popup');
      document.getElementById('popupTitle').textContent = music.title;

      const audio = document.getElementById('audioPlayer');
      audio.src = music.file;
      audio.play();

      popup.style.display = 'block';
    }

    function closePopup() {
      const popup = document.getElementById('popup');
      const audio = document.getElementById('audioPlayer');
      audio.pause();
      popup.style.display = 'none';
    }
  </script>

</body>
</html>
